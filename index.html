<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <title>Pac-Man Game</title>
    <style>

        html {
            touch-action: manipulation; /* –û—Ç–∫–ª—é—á–∞–µ—Ç double-tap zoom */
            -webkit-text-size-adjust: 100%; /* –î–ª—è Safari */
        }

        body {
            touch-action: manipulation;
            -webkit-touch-callout: none; /* –û—Ç–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é */
            -webkit-user-select: none; /* –û—Ç–∫–ª—é—á–∞–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ */
            user-select: none;

        }

        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .arrow-btn {
            touch-action: manipulation;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent; /* –£–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø—Ä–∏ —Ç–∞–ø–µ */
        }

        body {
            margin: 0;
            padding: 20px;
            background: #000;
            font-family: 'JetBrains Mono', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow: hidden; 
            box-sizing: border-box; 
        }

        .game-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 360px;
            width: 100%;
            max-height: 620px;
            border-radius: 16px;
            position: relative;
        }


        .game-field {
            width: 360px;
            height: 410px;
            background: #092B1A;
            border: 3px solid #0B4F2D;
            position: relative;
            overflow: hidden;
            box-sizing: border-box; 
            border-radius: 24px;
        }

        .maze {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–µ–Ω—ã */
        .wall-h {
            position: absolute;
            height: 4px;
            background: #0B4F2D;
            border-radius: 4px;
        }

        /* –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç–µ–Ω—ã */
        .wall-v {
            position: absolute;
            width: 4px;
            background: #0B4F2D;
            border-radius: 4px;
        }

        /* –í–Ω–µ—à–Ω–∏–µ —Å—Ç–µ–Ω—ã */
        .outer-wall-top { top: 20px; left: 20px; right: 20px; }
        .outer-wall-bottom { bottom: 20px; left: 20px; right: 20px; }
        .outer-wall-left { top: 20px; left: 20px; bottom: 20px; }
        .outer-wall-right { top: 20px; right: 20px; bottom: 20px; }

        /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç–µ–Ω—ã - —Å–æ–∑–¥–∞–µ–º –ª–∞–±–∏—Ä–∏–Ω—Ç */
        .inner-wall-1 { top: 68px; left: 68px; width: 80px; }
        .inner-wall-2 { top: 68px; right: 64px; width: 80px; }
        .inner-wall-3 { top: 68px; left: 68px; height: 80px; }
        .inner-wall-4 { top: 68px; right: 64px; height: 80px; }
        
        .inner-wall-5 { top: 115px; left: 140px; width: 80px; }
        .inner-wall-6 { top: 184px; left: 140px; height: 40px; }
        .inner-wall-7 { top: 184px; right: 136px; height: 40px; }
        
        .inner-wall-8 { top: 257px; left: 68px; height: 80px; }
        .inner-wall-9 { top: 257px; right: 64px; height: 80px; }
        
        .inner-wall-10 { top: 335px; left: 68px; width: 80px; }
        .inner-wall-11 { top: 335px; right: 64px; width: 80px; }
        
        .inner-wall-12 { top: 286px; left: 140px; width: 80px; }

        .pacman {
            position: absolute;
            width: 28px;
            height: 28px;
            background-image: url('./images/Watermelon.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 10;
            transition: none;
            transform-origin: center center;
        }

        /* –ü–æ–≤–æ—Ä–æ—Ç —Å–ø—Ä–∞–π—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .pacman.right { transform: rotate(0deg); }
        .pacman.left { transform: rotate(180deg); }
        .pacman.up { transform: rotate(-90deg); }
        .pacman.down { transform: rotate(90deg); }

        /* –ê–Ω–∏–º–∞—Ü–∏—è "–¥—ã—Ö–∞–Ω–∏—è" –¥–ª—è Pac-Man */
        @keyframes pacman-breathing {
            0% { transform: scale(1); }
            50% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }
        @keyframes pacman-breathing-right {
            0% { transform: scaleX(1) scale(1); }
            50% { transform: scaleX(1) scale(0.9); }
            100% { transform: scaleX(1) scale(1); }
        }
        @keyframes pacman-breathing-left {
            0% { transform: scaleX(-1) scale(1); }
            50% { transform: scaleX(-1) scale(0.9); }
            100% { transform: scaleX(-1) scale(1); }
        }
        @keyframes pacman-breathing-up {
            0% { transform: rotate(-90deg) scale(1); }
            50% { transform: rotate(-90deg) scale(0.9); }
            100% { transform: rotate(-90deg) scale(1); }
        }
        @keyframes pacman-breathing-down {
            0% { transform: rotate(90deg) scale(1); }
            50% { transform: rotate(90deg) scale(0.9); }
            100% { transform: rotate(90deg) scale(1); }
        }

        /* –î—ã—Ö–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ë–ï–ó –Ω–µ—É—è–∑–≤–∏–º–æ—Å—Ç–∏ */
        .pacman.right.moving:not(.invincible) { 
            animation: pacman-breathing-right 0.3s ease-in-out infinite;
        }
        .pacman.left.moving:not(.invincible) { 
            animation: pacman-breathing-left 0.3s ease-in-out infinite;
        }
        .pacman.up.moving:not(.invincible) { 
            animation: pacman-breathing-up 0.3s ease-in-out infinite;
        }
        .pacman.down.moving:not(.invincible) { 
            animation: pacman-breathing-down 0.3s ease-in-out infinite;
        }

        /* –û–±—ã—á–Ω—ã–µ –ø–æ–≤–æ—Ä–æ—Ç—ã –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ */
        .pacman.right { transform: scaleX(1); }
        .pacman.left { transform: scaleX(-1); }
        .pacman.up { transform: rotate(-90deg); }
        .pacman.down { transform: rotate(90deg); }

        /* –ú–∏–≥–∞–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø–æ–≤–æ—Ä–æ—Ç–∞ - –æ–±—ä–µ–¥–∏–Ω—è–µ–º opacity –∏ transform */
        @keyframes blink-right {
            0%, 49% { opacity: 1; transform: scaleX(1); }
            50%, 100% { opacity: 0.3; transform: scaleX(1); }
        }
        @keyframes blink-left {
            0%, 49% { opacity: 1; transform: scaleX(-1); }
            50%, 100% { opacity: 0.3; transform: scaleX(-1); }
        }
        @keyframes blink-up {
            0%, 49% { opacity: 1; transform: rotate(-90deg); }
            50%, 100% { opacity: 0.3; transform: rotate(-90deg); }
        }
        @keyframes blink-down {
            0%, 49% { opacity: 1; transform: rotate(90deg); }
            50%, 100% { opacity: 0.3; transform: rotate(90deg); }
        }

        /* –ú–∏–≥–∞–Ω–∏–µ –í–û –í–†–ï–ú–Ø –Ω–µ—É—è–∑–≤–∏–º–æ—Å—Ç–∏ - –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ */
        .pacman.invincible.right {
            animation: blink-right 0.3s infinite !important;
        }
        .pacman.invincible.left {
            animation: blink-left 0.3s infinite !important;
        }
        .pacman.invincible.up {
            animation: blink-up 0.3s infinite !important;
        }
        .pacman.invincible.down {
            animation: blink-down 0.3s infinite !important;
        }

        /* –í—Ä–∞–≥–∏ */
        .enemy {
            position: absolute;
            width: 32px;
            height: 32px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 8;
        }

        .enemy-0 {
            background-image: url('./images/frog_1.png'); 
        }

        .enemy-1 {
            background-image: url('./images/frog_2.png'); 
        }

        .enemy-2 {
            background-image: url('./images/frog_3.png'); 
        }

        .enemy-3 {
            background-image: url('./images/frog_4.png');
        }

        /* –í—Ä–∞–≥–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º–∏ –≤–æ –≤—Ä–µ–º—è power-up */
        .enemy.scared {
            opacity: 0.5;
            transition: opacity 0.3s;
        }

        /* –ú–∏–≥–∞–Ω–∏–µ –≤—Ä–∞–≥–æ–≤ –ø–µ—Ä–µ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏–µ–º power-up */
        @keyframes enemy-warning {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }

        .enemy.scared.warning {
            animation: enemy-warning 0.3s infinite;
        }

        .score-panel {
            background: #1a1a1a;
            border: 3px solid #363636;
            border-radius: 24px;
            padding: 20px;
            display: flex;
            flex-direction: column; 
            gap: 46px; 
            color: #ffffff;
            font-size: 16px;
            width: 100%;
            box-sizing: border-box;
        }

        .score-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }


        #score-display {
            font-weight: regular;
            font-size: 20px;
        }

        .score-bottom {
            width: 100%;
            display: flex;
            justify-content: space-between; 
            gap: 16px;
        }

        .stat-block {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
            flex: 1; 
        }

        .stat-label {
            font-size: 12px;
            color: #ffffff;
            text-align: left;
        }

        .stat-icon {
            height: 24px;
            width: auto;
            object-fit: contain;
        }

        /* –¢–æ—á–∫–∏ –¥–ª—è —Å–±–æ—Ä–∞ */
        .dot {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #FEB3C3;
            border-radius: 50%;
            z-index: 5;
        }

        /* –≠–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã */
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 360px;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: #ffffff;
        }

        .game-over h1 {
            font-size: 30px;
            margin-bottom: 2px;
            color: #ffffff;
        }

        .game-over p {
            font-size: 14px;
            margin-bottom: 0px;
            text-align: center;
            padding: 0 10px; 
        }

        .game-over p:last-of-type {
            margin-bottom: 32px; 
        }

        .restart-btn {
            padding: 8px 24px; 
            font-size: 20px; 
            background: #ffffff;
            border: 0px solid #ffffff;
            color: #000000;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 0;
        }

        /* –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω */
        .start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 360px;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: #ffffff;
        }

        .start-screen h1 {
            font-size: 30px;
            margin-bottom: 2px;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0);
        }

        .start-screen p {
            font-size: 14px;
            margin-bottom: 0px;
            text-align: center;
            padding: 0 10px; 
        }

        .start-screen p:last-of-type {
            margin-bottom: 32px; 
        }

        .start-btn {
            padding: 8px 24px; 
            font-size: 20px; 
            background: #ffffff;
            border: 0px solid #ffffff;
            color: #000000;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 0;
        }

        /* –≠–∫—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π */
        .instructions-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 360px;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            padding: 20px;
            box-sizing: border-box;
        }

        .instructions-container {
            display: flex;
            flex-direction: column;
            gap: 0px;
            width: 100%;
            max-width: 320px;
            align-items: center;
        }

        .instruction-block {
            background: rgba(0, 0, 0, 0);
            border: 0px solid #FFD700;
            border-radius: 10px;
            padding: 15px;
            color: #ffffff;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .instruction-icon {
            flex-shrink: 0;
            width: 72px;
            height: 72px;
        }

        .instruction-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .instruction-text {
            flex: 1;
            font-size: 14px;
            line-height: 1.4;
        }

        .instructions-screen .start-btn {
            margin-top: 15px; /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–Ω–æ–ø–∫–∏ */
        }

        /* Power-up (—É—Å–∫–æ—Ä–µ–Ω–∏–µ) */
        .speed-powerup {
            position: absolute;
            width: 16px;
            height: 16px;
            background: #90EE90;
            border-radius: 50%;
            z-index: 9;
            box-shadow: 0 0 10px #90EE90;
            animation: pulse 1s ease-in-out infinite alternate;
        }

        @keyframes pulse {
            0% { opacity: 0.7; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.2); }
        }

        /* –ñ–∏–∑–Ω–∏ */
        .lives-container {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        /* –ñ–∏–∑–Ω–∏ */
        .heart {
            width: 28px;
            height: 24px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            display: inline-block;
        }

        .heart.active {
            background-image: url('./images/heart_on.svg');
        }

        .heart.inactive {
            background-image: url('./images/heart_off.svg');
        }

        .pink-dot {
            position: absolute;
            width: 28px;
            height: 22px;
            background-image: url('./images/006.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 9;
            filter: drop-shadow(0 0 15px #FF69B4) drop-shadow(0 0 25px #FF1493);
            animation: pulse-simple 1s ease-in-out infinite alternate;
            will-change: transform;
            transform: translateZ(0);
        }

        @keyframes pulse-simple {
            0% { transform: scale(1) translateZ(0); }
            100% { transform: scale(1.2) translateZ(0); }
        }

        /* –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã */
        .win-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 360px;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: #ffffff;
        }

        .win-screen h1 {
            font-size: 30px;
            margin-bottom: 2px;
            color: #ffffff;
            text-align: center;
            padding: 0 20px;
        }

        .win-screen p {
            font-size: 14px;
            margin-bottom: 0px;
            text-align: center;
        }

        .win-screen p:last-of-type {
            margin-bottom: 32px; 
        }

        h1 {
            font-size: 30px;
            font-weight: 400;
        }

        /* –ü–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ (—É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º) */
        .debug-panel {
            background: #2a2a2a;
            border: 2px solid #666;
            border-radius: 10px;
            padding: 10px;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .debug-panel button {
            padding: 8px 12px;
            font-size: 14px;
            background: #444;
            border: 1px solid #666;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'JetBrains Mono', monospace;
        }

        .debug-panel button:hover {
            background: #555;
        }

        .debug-panel button:active {
            background: #333;
        }

    </style>
</head>
<body>
    <div class="game-container">
                        <!-- –≠–∫—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π -->
                <div class="instructions-screen" id="instructions-screen">
                    <div class="instructions-container">
                        <div class="instruction-block">
                            <div class="instruction-icon">
                                <img src="./images/swipe_big.png" alt="">
                            </div>
                            <div class="instruction-text">
                                –°–≤–∞–π–ø–∞–π—Ç–µ, —á—Ç–æ–±—ã –º–µ–Ω—è—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
                            </div>
                        </div>
                        <div class="instruction-block">
                            <div class="instruction-icon">
                                <img src="./images/enemies_big.png" alt="">
                            </div>
                            <div class="instruction-text">
                                –ò–∑–±–µ–≥–∞–π—Ç–µ –≤—Ä–∞–≥–æ–≤. –û–Ω–∏ –±—É–¥—É—Ç –≤–∞—Å –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞—Ç—å
                            </div>
                        </div>
                        <div class="instruction-block">
                            <div class="instruction-icon">
                                <img src="./images/bonus_big.png" alt="">
                            </div>
                            <div class="instruction-text">
                                –°—ä–µ—à—å—Ç–µ –±–æ–Ω—É—Å, —á—Ç–æ–±—ã —Å—Ç–∞—Ç—å –±–µ—Å—Å–º–µ—Ä—Ç–Ω—ã–º –∏ –µ—Å—Ç—å –≤—Ä–∞–≥–æ–≤
                            </div>
                        </div>
                        <button class="start-btn" onclick="startGameFromInstructions()">–ü–æ–Ω—è—Ç–Ω–æ, –ø–æ–≥–Ω–∞–ª–∏</button>
                    </div>
                </div>
                                <!-- –°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω -->
                <div class="start-screen" id="start-screen">
                    <h1>–°–ø–ª–∏—Ç–æ–≤–∞–Ω–∏–µ</h1>
                    <p>–°–æ–±–∏—Ä–∞–π—Ç–µ —Ç–æ—á–∫–∏ <br>–∏ –∏–∑–±–µ–≥–∞–π—Ç–µ –≤—Ä–∞–≥–æ–≤!</p>
                    <button class="start-btn" onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                </div>


                <!-- –≠–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã -->
                <div class="game-over" id="game-over">
                    <h1>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞</h1>
                    <p>–í–∞—à —Å—á—ë—Ç: <span id="final-score">0</span></p>
                    <button class="restart-btn" onclick="restartGame()">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                </div>

                <!-- –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã -->
                <div class="win-screen" id="win-screen">
                    <h1>–ü–æ–±–µ–¥–∞!</h1>
                    <p>–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ —Å—É–ø–µ—Ä –°–ø–ª–∏—Ç<br> –Ω–∞ 6 –º–µ—Å—è—Ü–µ–≤ –±–µ–∑ –ø–µ—Ä–µ–ø–ª–∞—Ç!</p>
                    <p>–í–∞—à —Å—á—ë—Ç: <span id="win-score">0</span></p>
                    <button class="restart-btn" onclick="restartGame()">–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É</button>
                </div>

        <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
        <div class="game-field">
            <div class="maze">
                <!-- –í–Ω–µ—à–Ω–∏–µ —Å—Ç–µ–Ω—ã -->
                <div class="wall-h outer-wall-top"></div>
                <div class="wall-h outer-wall-bottom"></div>
                <div class="wall-v outer-wall-left"></div>
                <div class="wall-v outer-wall-right"></div>
                
                <!-- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç–µ–Ω—ã –ª–∞–±–∏—Ä–∏–Ω—Ç–∞ -->
                <div class="wall-h inner-wall-1"></div>
                <div class="wall-h inner-wall-2"></div>
                <div class="wall-v inner-wall-3"></div>
                <div class="wall-v inner-wall-4"></div>
                
                <div class="wall-h inner-wall-5"></div>
                <div class="wall-v inner-wall-6"></div>
                <div class="wall-v inner-wall-7"></div>
                
                <div class="wall-v inner-wall-8"></div>
                <div class="wall-v inner-wall-9"></div>
                
                <div class="wall-h inner-wall-10"></div>
                <div class="wall-h inner-wall-11"></div>
                
                <div class="wall-h inner-wall-12"></div>
                <div class="wall-h inner-wall-13"></div>
                
                <div class="wall-h inner-wall-14"></div>


                                
                <!-- Pac-Man -->
                <div class="pacman right" id="pacman"></div>
            </div>
        </div>

        <div class="score-panel">
            <div class="score-top">
                <span id="score-display">–°—á—ë—Ç: 0</span>
                <div class="lives-container" id="lives-container"></div>
            </div>
        <div class="score-bottom" id="score-bottom">
            <div class="stat-block">
                <div class="stat-label">–°–≤–∞–π–ø–∞–π—Ç–µ <br>–¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è</div>
                <img src="./images/swipe_1.png" class="stat-icon" alt="">
            </div>
            <div class="stat-block">
                <div class="stat-label">–ò–∑–±–µ–≥–∞–π—Ç–µ <br>–∂–∞–±-–º–æ–Ω–µ—Ç</div>
                <img src="./images/enemyes.png" class="stat-icon" alt="">
            </div>
            <div class="stat-block">
                <div class="stat-label">–ë–æ–Ω—É—Å –¥–∞—ë—Ç<br>—Å—É–ø–µ—Ä—Å–∏–ª—É</div>
                <img src="./images/bonus_1.png" class="stat-icon" alt="">
            </div>
        </div>
        </div>
        <!-- –ü–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ (—É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º)
        <div class="debug-panel">
            <button onclick="gameOver()">üî¥ –ü–æ—Ä–∞–∂–µ–Ω–∏–µ</button>
            <button onclick="winGame()">üü¢ –ü–æ–±–µ–¥–∞</button>
            <button onclick="restartGame()">üîÑ –†–µ—Å—Ç–∞—Ä—Ç</button>
            <button onclick="loseLife()">üíî -1 –∂–∏–∑–Ω—å</button>
        </div> -->
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        const pacman = document.getElementById('pacman');
        const gameField = document.querySelector('.game-field');
        let pacmanX = 170;
        let pacmanY = 185;
        let direction = null;
        let isMoving = false;
        let gameLoop;
        let lives = 3;
        let isInvincible = false;
        let pinkDot = null;
        let allDotsCollected = false;

        const PACMAN_SIZE = 32;
        let MOVE_SPEED = 2; // –≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∞ –î–û originalSpeed
        const FIELD_PADDING = 20;
        const FIELD_SIZE = 360;
        const FIELD_HEIGHT = 400;

        // Power-up –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - –ü–û–°–õ–ï –æ–±—ä—è–≤–ª–µ–Ω–∏—è MOVE_SPEED
        let speedPowerupUsed = false;
        let speedPowerupActive = false;
        let speedPowerup = null;
        let originalSpeed = MOVE_SPEED; // –¢–µ–ø–µ—Ä—å MOVE_SPEED —É–∂–µ –æ–±—ä—è–≤–ª–µ–Ω–∞

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameActive = true;
        let gameStarted = false;
        let score = 0;
        const DOT_SIZE = 4;
        const DOT_SPACING = 24.4;
        const dots = [];
        const enemies = [];
        const ENEMY_SIZE = 32;
        const ENEMY_SPEED = 1.2;
        const ENEMY_COUNT = 4;



        // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã
        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞)
        function startGame() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('instructions-screen').style.display = 'flex';
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø–æ—Å–ª–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
        function startGameFromInstructions() {
            gameStarted = true;
            gameActive = true;
            lives = 3;
            updateLives();
            
            document.getElementById('instructions-screen').style.display = 'none';
            
            initPacman();
            createDots();
            createEnemies();
            createSpeedPowerup();
        }

        // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
function preloadImages() {
    const imageUrls = [
        // Pac-Man
        'https://i.ibb.co/PGx61jWg/Watermelon.png',
        
        // –í—Ä–∞–≥–∏ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–∏ —Å—Å—ã–ª–∫–∏)
        'https://i.ibb.co/84NnMSpY/Image.png',
        'https://i.ibb.co/9mNkw8jy/Image-1.png',
        'https://i.ibb.co/Df1NYN5y/Image-3.png', 
        'https://i.ibb.co/vxSfFmzM/Image-2.png',
        
        // –ö–Ω–æ–ø–∫–∏ –æ–±—ã—á–Ω—ã–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à–∏ —Å—Å—ã–ª–∫–∏)
        'https://i.ibb.co/zT7NtYhW/Property-1-top-off.png',
        'https://i.ibb.co/cGvz99F/Property-1-left-off.png',
        'https://i.ibb.co/qLPtGxM4/Property-1-top-off-1.png',
        'https://i.ibb.co/d0nrvYDH/Property-1-right-off.png',
        
        // –ö–Ω–æ–ø–∫–∏ –Ω–∞–∂–∞—Ç—ã–µ
        'https://i.ibb.co/RpJjyyG0/Property-1-top-on.png',
        'https://i.ibb.co/BvtHBZG/Property-1-left-on.png',
        'https://i.ibb.co/qHqpnJ2/Property-1-top-on-1.png',
        'https://i.ibb.co/NgrN2fhM/Property-1-right-on.png'
    ];
    
    const promises = imageUrls.map(url => {
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => resolve(img);
            img.onerror = () => reject(new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å: ${url}`));
            img.src = url;
        });
    });
    
    return Promise.all(promises);
}
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–∏ Pac-Man'–∞
        function initPacman() {
            pacman.style.left = pacmanX + 'px';
            pacman.style.top = pacmanY + 'px';
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ—á–µ–∫ –Ω–∞ –∫–∞—Ä—Ç–µ
        function createDots() {
            const dotsContainer = document.createElement('div');
            dotsContainer.id = 'dots-container';
            gameField.appendChild(dotsContainer);
            
            for (let x = FIELD_PADDING + DOT_SPACING; x < FIELD_SIZE - FIELD_PADDING; x += DOT_SPACING) {
                 for (let y = FIELD_PADDING + DOT_SPACING; y < FIELD_HEIGHT - FIELD_PADDING; y += DOT_SPACING) { // –∏—Å–ø–æ–ª—å–∑—É–µ–º FIELD_HEIGHT
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è –ª–∏ —Ç–æ—á–∫–∞ —Å–æ —Å—Ç–µ–Ω–æ–π
                    if (!checkDotWallCollision(x, y)) {
                        const dot = document.createElement('div');
                        dot.className = 'dot';
                        dot.style.left = (x - DOT_SIZE/2) + 'px';
                        dot.style.top = (y - DOT_SIZE/2) + 'px';
                        dotsContainer.appendChild(dot);
                        dots.push({x: x, y: y, element: dot, collected: false});
                    }
                }
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
        function createEnemies() {
            const enemyPositions = [
                {x: 295, y: 344},
                {x: 30, y: 340},
                {x: 300, y: 30},
                {x: 30, y: 30}
            ];
            
            for (let i = 0; i < ENEMY_COUNT; i++) {
                const enemy = document.createElement('div');
                enemy.className = 'enemy enemy-' + i; // –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å –∫ –∫–ª–∞—Å—Å—É
                enemy.id = 'enemy-' + i;
                gameField.appendChild(enemy);
                
                const pos = enemyPositions[i];
                const enemyData = {
                    element: enemy,
                    x: pos.x,
                    y: pos.y,
                    direction: getRandomDirection(),
                    moveCounter: 0,
                        chasing: false // –î–æ–±–∞–≤–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É
                };
                
                enemy.style.left = enemyData.x + 'px';
                enemy.style.top = enemyData.y + 'px';
                enemies.push(enemyData);
            }
            
            // –ó–∞–ø—É—Å–∫ –¥–≤–∏–∂–µ–Ω–∏—è –≤—Ä–∞–≥–æ–≤
            setInterval(moveEnemies, 20); // ~50 FPS
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ power-up —É—Å–∫–æ—Ä–µ–Ω–∏—è
function createSpeedPowerup() {
    if (speedPowerupUsed) return;
    
    // –°–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ—è–≤–ª–µ–Ω–∏—è (30-60 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã)
    const delay = Math.random() * 30000 + 30000;
    
    setTimeout(() => {
        if (!gameActive || speedPowerupUsed) return;
        
        // –ù–∞—Ö–æ–¥–∏–º —Å–ª—É—á–∞–π–Ω—É—é —Å–≤–æ–±–æ–¥–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
        let x, y;
        let attempts = 0;
        do {
            x = Math.random() * (FIELD_SIZE - 100) + 50;
            y = Math.random() * (FIELD_HEIGHT - 100) + 50; // –∏—Å–ø–æ–ª—å–∑—É–µ–º FIELD_HEIGHT
            attempts++;
        } while (checkDotWallCollision(x, y) && attempts < 50);
        
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç
        const powerupElement = document.createElement('div');
        powerupElement.className = 'speed-powerup';
        powerupElement.style.left = (x - 8) + 'px';
        powerupElement.style.top = (y - 8) + 'px';
        gameField.appendChild(powerupElement);
        
        speedPowerup = {
            element: powerupElement,
            x: x,
            y: y,
            collected: false
        };
        
        // –£–±–∏—Ä–∞–µ–º power-up —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –µ—Å–ª–∏ –Ω–µ —Å–æ–±—Ä–∞–Ω
        setTimeout(() => {
            if (speedPowerup && !speedPowerup.collected) {
                speedPowerup.element.remove();
                speedPowerup = null;
            }
        }, 5000);
        
    }, delay);
}

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∞ power-up
        function checkPowerupCollection() {
            if (!speedPowerup || speedPowerup.collected) return;
            
            const pacmanCenterX = pacmanX + PACMAN_SIZE/2;
            const pacmanCenterY = pacmanY + PACMAN_SIZE/2;
            
            const distance = Math.sqrt(
                Math.pow(pacmanCenterX - speedPowerup.x, 2) + 
                Math.pow(pacmanCenterY - speedPowerup.y, 2)
            );
            
            if (distance < 15) {
                // –°–æ–±–∏—Ä–∞–µ–º power-up
                speedPowerup.collected = true;
                speedPowerup.element.remove();
                speedPowerupUsed = true;
                speedPowerup = null;
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —É—Å–∫–æ—Ä–µ–Ω–∏–µ
                activateSpeedPowerup();
            }
        }

        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
        function activateSpeedPowerup() {
            speedPowerupActive = true;
            MOVE_SPEED = originalSpeed * 2; // –£–¥–≤–∞–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å
            

                // –î–µ–ª–∞–µ–º –≤—Ä–∞–≥–æ–≤ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º–∏
            enemies.forEach(enemy => {
                if (!enemy.destroyed) {
                    enemy.element.classList.add('scared');
                }
            });

                // –ó–∞ 2 —Å–µ–∫—É–Ω–¥—ã –¥–æ –∫–æ–Ω—Ü–∞ - –Ω–∞—á–∏–Ω–∞–µ–º –º–∏–≥–∞—Ç—å
            setTimeout(() => {
                enemies.forEach(enemy => {
                    if (!enemy.destroyed) {
                        enemy.element.classList.add('warning');
                    }
                });
                console.log('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ - —Å–∫–æ—Ä–æ –∫–æ–Ω–µ—Ü —É—Å–∫–æ—Ä–µ–Ω–∏—è!');
            }, 3000);
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ã—á–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                MOVE_SPEED = originalSpeed;
                speedPowerupActive = false;

            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤—Ä–∞–≥–∞–º –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –≤–∏–¥
                enemies.forEach(enemy => {
                    enemy.element.classList.remove('scared');
                    enemy.element.classList.remove('warning');
                });
            }, 5000);
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        function getRandomDirection() {
            const directions = ['up', 'down', 'left', 'right'];
            return directions[Math.floor(Math.random() * directions.length)];
        }

        // –î–≤–∏–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
        function moveEnemies() {
            if (!gameActive) return;
            
            const pacmanCenterX = pacmanX + PACMAN_SIZE/2;
            const pacmanCenterY = pacmanY + PACMAN_SIZE/2;
            
            enemies.forEach(enemy => {
                if (enemy.destroyed) return;
                const enemyCenterX = enemy.x + ENEMY_SIZE/2;
                const enemyCenterY = enemy.y + ENEMY_SIZE/2;
                
                // –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ Pac-Man'–∞
                const distanceToPacman = Math.sqrt(
                    Math.pow(pacmanCenterX - enemyCenterX, 2) + 
                    Math.pow(pacmanCenterY - enemyCenterY, 2)
                );
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∂–∏–º –ø–æ–≤–µ–¥–µ–Ω–∏—è
                if (distanceToPacman <= 80 && !isInvincible) {
                    // –†–µ–∂–∏–º –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è - –¥–≤–∏–≥–∞–µ–º—Å—è –∫ Pac-Man'—É
                    enemy.chasing = true;
                    enemy.direction = getDirectionToPacman(enemy.x, enemy.y, pacmanX, pacmanY);
                } else if (distanceToPacman >= 140 && enemy.chasing) {
                    // –í—ã—Ö–æ–¥ –∏–∑ —Ä–µ–∂–∏–º–∞ –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
                    enemy.chasing = false;
                    enemy.direction = getRandomDirection();
                    enemy.moveCounter = 0;
                }
                
                let newX = enemy.x;
                let newY = enemy.y;
                
                switch(enemy.direction) {
                    case 'up':
                        newY -= ENEMY_SPEED;
                        break;
                    case 'down':
                        newY += ENEMY_SPEED;
                        break;
                    case 'left':
                        newX -= ENEMY_SPEED;
                        break;
                    case 'right':
                        newX += ENEMY_SPEED;
                        break;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å–æ —Å—Ç–µ–Ω–æ–π
                if (!checkEnemyWallCollision(newX, newY)) {
                    enemy.x = newX;
                    enemy.y = newY;
                    enemy.element.style.left = enemy.x + 'px';
                    enemy.element.style.top = enemy.y + 'px';
                    enemy.moveCounter++;
                } else {
                    // –ü—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ –º–µ–Ω—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    if (enemy.chasing) {
                        // –ï—Å–ª–∏ –ø—Ä–µ—Å–ª–µ–¥—É–µ–º, –ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫ —Ü–µ–ª–∏
                        enemy.direction = getAlternativeDirectionToPacman(enemy.x, enemy.y, pacmanX, pacmanY);
                    } else {
                        enemy.direction = getRandomDirection();
                    }
                }
                
                // –°–ª—É—á–∞–π–Ω–æ –º–µ–Ω—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
                if (!enemy.chasing && enemy.moveCounter > Math.random() * 100 + 100) {
                    enemy.direction = getRandomDirection();
                    enemy.moveCounter = 0;
                }
            });
        }

        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫ Pac-Man'—É
        function getDirectionToPacman(enemyX, enemyY, pacmanX, pacmanY) {
            const deltaX = pacmanX - enemyX;
            const deltaY = pacmanY - enemyY;
            
            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                return deltaX > 0 ? 'right' : 'left';
            } else {
                return deltaY > 0 ? 'down' : 'up';
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫ Pac-Man'—É –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ —Å–æ —Å—Ç–µ–Ω–æ–π
        function getAlternativeDirectionToPacman(enemyX, enemyY, pacmanX, pacmanY) {
            const deltaX = pacmanX - enemyX;
            const deltaY = pacmanY - enemyY;
            
            const directions = [];
            
            if (deltaX > 0) directions.push('right');
            if (deltaX < 0) directions.push('left');
            if (deltaY > 0) directions.push('down');
            if (deltaY < 0) directions.push('up');
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö
            return directions[Math.floor(Math.random() * directions.length)] || getRandomDirection();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –≤—Ä–∞–≥–∞–º–∏
            function checkEnemyCollision() {
                if (!gameActive || isInvincible) return; // –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å–ª–∏ –Ω–µ—É—è–∑–≤–∏–º—ã
                
                const pacmanCenterX = pacmanX + PACMAN_SIZE/2;
                const pacmanCenterY = pacmanY + PACMAN_SIZE/2;
                
                enemies.forEach((enemy, index) => {
                    if (enemy.destroyed) return;
                    
                    const enemyCenterX = enemy.x + ENEMY_SIZE/2;
                    const enemyCenterY = enemy.y + ENEMY_SIZE/2;
                    
                    const distance = Math.sqrt(
                        Math.pow(pacmanCenterX - enemyCenterX, 2) + 
                        Math.pow(pacmanCenterY - enemyCenterY, 2)
                    );
                    
                    if (distance < 20) {
                        if (speedPowerupActive) {
                            // –í–æ –≤—Ä–µ–º—è —É—Å–∫–æ—Ä–µ–Ω–∏—è - —É–Ω–∏—á—Ç–æ–∂–∞–µ–º –≤—Ä–∞–≥–∞
                            destroyEnemy(enemy, index);
                        } else {
                            // –û–±—ã—á–Ω–æ–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ - —Ç–µ—Ä—è–µ–º –∂–∏–∑–Ω—å
                            loseLife();
                        }
                    }
                });
            }

            // –ü–æ—Ç–µ—Ä—è –∂–∏–∑–Ω–∏
            function loseLife() {
                lives--;
                updateLives();
                
                if (lives <= 0) {
                    // –í—Å–µ –∂–∏–∑–Ω–∏ –ø–æ—Ç–µ—Ä—è–Ω—ã - –∫–æ–Ω–µ—Ü –∏–≥—Ä—ã
                    gameOver();
                } else {
                    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω–µ—É—è–∑–≤–∏–º–æ—Å—Ç—å –Ω–∞ 3 —Å–µ–∫—É–Ω–¥—ã
                    activateInvincibility();
                }
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∂–∏–∑–Ω–µ–π
            function updateLives() {
                const livesContainer = document.getElementById('lives-container');
                livesContainer.innerHTML = '';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º 3 —Å–µ—Ä–¥–µ—á–∫–∞ –≤—Å–µ–≥–¥–∞
                for (let i = 0; i < 3; i++) {
                    const heart = document.createElement('span');
                    heart.className = 'heart';
                    
                    if (i < lives) {
                        heart.classList.add('active'); // –ñ–∏–≤–æ–µ —Å–µ—Ä–¥–µ—á–∫–æ
                    } else {
                        heart.classList.add('inactive'); // –ü–æ—Ç–µ—Ä—è–Ω–Ω–æ–µ —Å–µ—Ä–¥–µ—á–∫–æ
                    }
                    
                    livesContainer.appendChild(heart);
                }
            }

            // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –Ω–µ—É—è–∑–≤–∏–º–æ—Å—Ç–∏
            function activateInvincibility() {
                isInvincible = true;
                pacman.classList.add('invincible');
                
                console.log('–ù–µ—É—è–∑–≤–∏–º–æ—Å—Ç—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ 3 —Å–µ–∫—É–Ω–¥—ã');
                
                // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã —É–±–∏—Ä–∞–µ–º –Ω–µ—É—è–∑–≤–∏–º–æ—Å—Ç—å
                setTimeout(() => {
                    isInvincible = false;
                    pacman.classList.remove('invincible');
                    console.log('–ù–µ—É—è–∑–≤–∏–º–æ—Å—Ç—å –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å');
                }, 3000);
            }

        // –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –≤—Ä–∞–≥–∞
        function destroyEnemy(enemy, index) {
            enemy.destroyed = true;
            enemy.element.style.display = 'none';
            enemy.element.style.visibility = 'hidden'; // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞
            console.log('–í—Ä–∞–≥ —É–Ω–∏—á—Ç–æ–∂–µ–Ω!');
        }

        // –û–∫–æ–Ω—á–∞–Ω–∏–µ –∏–≥—Ä—ã
        function gameOver() {
            gameActive = false;
            stopPacman();
            
            // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤
            enemies.forEach(enemy => {
                enemy.direction = null;
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
            document.getElementById('final-score').textContent = score;
            document.getElementById('game-over').style.display = 'flex';
        }

        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        function restartGame() {

            allDotsCollected = false;
                if (pinkDot && pinkDot.element) {
                    pinkDot.element.remove();
                }
                pinkDot = null;

            lives = 3;
            isInvincible = false;
            pacman.classList.remove('invincible');
            updateLives();

            // –°–±—Ä–æ—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
            gameActive = true;
            score = 0;
            pacmanX = 170;
            pacmanY = 185;
            direction = null;
            isMoving = false;
            gameStarted = true;

            speedPowerupUsed = false;
            speedPowerupActive = false;
            MOVE_SPEED = originalSpeed;
            if (speedPowerup && speedPowerup.element) {
                speedPowerup.element.remove();
            }
            speedPowerup = null;

            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ Pac-Man
            initPacman();
            updateScore();
            
            // –°–±—Ä–æ—Å —Ç–æ—á–µ–∫
            dots.forEach(dot => {
                dot.collected = false;
                dot.element.style.display = 'block';
            });
            
            // –°–±—Ä–æ—Å –≤—Ä–∞–≥–æ–≤ –Ω–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
            const enemyPositions = [
                {x: 295, y: 344},
                {x: 30, y: 340},
                {x: 300, y: 30},
                {x: 30, y: 30}
            ];


            enemies.forEach((enemy, index) => {
    
    if (enemy.element) {
        enemy.x = enemyPositions[index].x;
        enemy.y = enemyPositions[index].y;
        enemy.direction = getRandomDirection();
        enemy.moveCounter = 0;
        enemy.chasing = false;
        enemy.destroyed = false;
        
        // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–∫—Ä—ã—Ç–∏—è
        enemy.element.style.display = '';
        enemy.element.style.visibility = '';
        enemy.element.style.opacity = '';
        enemy.element.className = 'enemy enemy-' + index; // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–ª–∞—Å—Å
        
        enemy.element.style.left = enemy.x + 'px';
        enemy.element.style.top = enemy.y + 'px';
        
    } else {
        console.log(`–û–®–ò–ë–ö–ê: –≠–ª–µ–º–µ–Ω—Ç –≤—Ä–∞–≥–∞ ${index} –Ω–µ –Ω–∞–π–¥–µ–Ω!`);
    }
});
            
            // –°–∫—Ä—ã—Ç—å —ç–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã
            document.getElementById('game-over').style.display = 'none';
            // –°–∫—Ä—ã—Ç—å —ç–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã
            document.getElementById('win-screen').style.display = 'none';

            gameStarted = true;
            createSpeedPowerup();
            document.getElementById('instructions-screen').style.display = 'none';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –≤—Ä–∞–≥–∞ —Å–æ —Å—Ç–µ–Ω–∞–º–∏
        function checkEnemyWallCollision(newX, newY) {
            const enemyRect = {
                left: newX,
                top: newY,
                right: newX + ENEMY_SIZE,
                bottom: newY + ENEMY_SIZE
            };
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü –ø–æ–ª—è
            if (newX < FIELD_PADDING || 
                newY < FIELD_PADDING || 
                newX + ENEMY_SIZE > FIELD_SIZE - FIELD_PADDING || 
                newY + ENEMY_SIZE > FIELD_HEIGHT - FIELD_PADDING) { // –∏—Å–ø–æ–ª—å–∑—É–µ–º FIELD_HEIGHT
                return true;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å–æ —Å—Ç–µ–Ω–∞–º–∏ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞
            const walls = document.querySelectorAll('.wall-h, .wall-v');
            
            for (let wall of walls) {
                const wallRect = wall.getBoundingClientRect();
                const fieldRect = gameField.getBoundingClientRect();
                
                const wallRelative = {
                    left: wallRect.left - fieldRect.left,
                    top: wallRect.top - fieldRect.top,
                    right: wallRect.right - fieldRect.left,
                    bottom: wallRect.bottom - fieldRect.top
                };
                
                if (enemyRect.left < wallRelative.right &&
                    enemyRect.right > wallRelative.left &&
                    enemyRect.top < wallRelative.bottom &&
                    enemyRect.bottom > wallRelative.top) {
                    return true;
                }
            }
            
            return false;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Ç–æ—á–∫–∏ —Å–æ —Å—Ç–µ–Ω–∞–º–∏
        function checkDotWallCollision(x, y) {
            const dotRect = {
                left: x - DOT_SIZE,
                top: y - DOT_SIZE,
                right: x + DOT_SIZE,
                bottom: y + DOT_SIZE
            };
            
            const walls = document.querySelectorAll('.wall-h, .wall-v');
            
            for (let wall of walls) {
                const wallRect = wall.getBoundingClientRect();
                const fieldRect = gameField.getBoundingClientRect();
                
                const wallRelative = {
                    left: wallRect.left - fieldRect.left,
                    top: wallRect.top - fieldRect.top,
                    right: wallRect.right - fieldRect.left,
                    bottom: wallRect.bottom - fieldRect.top
                };
                
                if (dotRect.left < wallRelative.right &&
                    dotRect.right > wallRelative.left &&
                    dotRect.top < wallRelative.bottom &&
                    dotRect.bottom > wallRelative.top) {
                    return true;
                }
            }
            
            return false;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å–æ —Å—Ç–µ–Ω–∞–º–∏
        function checkWallCollision(newX, newY) {
            const pacmanRect = {
                left: newX,
                top: newY,
                right: newX + PACMAN_SIZE,
                bottom: newY + PACMAN_SIZE
            };
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü –ø–æ–ª—è
            if (newX < FIELD_PADDING || 
                newY < FIELD_PADDING || 
                newX + PACMAN_SIZE > FIELD_SIZE - FIELD_PADDING || 
                newY + PACMAN_SIZE > FIELD_HEIGHT - FIELD_PADDING) { // –∏—Å–ø–æ–ª—å–∑—É–µ–º FIELD_HEIGHT
                return true;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å–æ —Å—Ç–µ–Ω–∞–º–∏ –ª–∞–±–∏—Ä–∏–Ω—Ç–∞
            const walls = document.querySelectorAll('.wall-h, .wall-v');
            
            for (let wall of walls) {
                const wallRect = wall.getBoundingClientRect();
                const fieldRect = gameField.getBoundingClientRect();
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å—Ç–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
                const wallRelative = {
                    left: wallRect.left - fieldRect.left,
                    top: wallRect.top - fieldRect.top,
                    right: wallRect.right - fieldRect.left,
                    bottom: wallRect.bottom - fieldRect.top
                };
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤
                if (pacmanRect.left < wallRelative.right &&
                    pacmanRect.right > wallRelative.left &&
                    pacmanRect.top < wallRelative.bottom &&
                    pacmanRect.bottom > wallRelative.top) {
                    return true;
                }
            }
            
            return false;
        }
        
        // –î–≤–∏–∂–µ–Ω–∏–µ Pac-Man'–∞
        function movePacman() {
            if (!isMoving || !direction) return;
            
            let newX = pacmanX;
            let newY = pacmanY;
            
            switch(direction) {
                case 'up':
                    newY -= MOVE_SPEED;
                    break;
                case 'down':
                    newY += MOVE_SPEED;
                    break;
                case 'left':
                    newX -= MOVE_SPEED;
                    break;
                case 'right':
                    newX += MOVE_SPEED;
                    break;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ
            if (!checkWallCollision(newX, newY)) {
                pacmanX = newX;
                pacmanY = newY;
                pacman.style.left = pacmanX + 'px';
                pacman.style.top = pacmanY + 'px';
                checkDotCollection();
                checkPowerupCollection();
                checkEnemyCollision();
                checkAllDotsCollected();
                checkPinkDotCollection();
            } else {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –ø—Ä–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–∏ —Å–æ —Å—Ç–µ–Ω–æ–π
                stopPacman();
            }
        }

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∞ —Ç–æ—á–µ–∫
            function checkDotCollection() {
                const pacmanCenterX = pacmanX + PACMAN_SIZE/2;
                const pacmanCenterY = pacmanY + PACMAN_SIZE/2;
                
                dots.forEach(dot => {
                    if (!dot.collected) {
                        const distance = Math.sqrt(
                            Math.pow(pacmanCenterX - dot.x, 2) + 
                            Math.pow(pacmanCenterY - dot.y, 2)
                        );
                        
                        if (distance < 14) { // –†–∞–¥–∏—É—Å —Å–±–æ—Ä–∞
                            dot.collected = true;
                            dot.element.style.display = 'none';
                            score += 5;
                            updateScore();
                        }
                    }
                });
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∞ –≤—Å–µ—Ö —Ç–æ—á–µ–∫
            function checkAllDotsCollected() {
                const remainingDots = dots.filter(dot => !dot.collected).length;
                
                if (remainingDots === 0 && !allDotsCollected) {
                    allDotsCollected = true;
                    createPinkDot();
                }
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–∑–æ–≤–æ–≥–æ –∫—Ä—É–∂–∫–∞
            function createPinkDot() {
                if (pinkDot) return;
                
                // –ù–∞—Ö–æ–¥–∏–º —Å–ª—É—á–∞–π–Ω—É—é —Å–≤–æ–±–æ–¥–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
                let x, y;
                let attempts = 0;
                do {
                    x = Math.random() * (FIELD_SIZE - 100) + 50;
                    y = Math.random() * (FIELD_HEIGHT - 100) + 50;
                    attempts++;
                } while (checkDotWallCollision(x, y) && attempts < 50);
                
                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç
                const pinkElement = document.createElement('div');
                pinkElement.className = 'pink-dot';
                pinkElement.style.left = (x - 14) + 'px'; // 28/2 = 14
                pinkElement.style.top = (y - 11) + 'px';  // 22/2 = 11
                gameField.appendChild(pinkElement);
                
                pinkDot = {
                    element: pinkElement,
                    x: x,
                    y: y,
                    collected: false
                };
                
                console.log('–†–æ–∑–æ–≤—ã–π –∫—Ä—É–∂–æ–∫ –ø–æ—è–≤–∏–ª—Å—è!');
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∞ —Ä–æ–∑–æ–≤–æ–≥–æ –∫—Ä—É–∂–∫–∞
            function checkPinkDotCollection() {
                if (!pinkDot || pinkDot.collected) return;
                
                const pacmanCenterX = pacmanX + PACMAN_SIZE/2;
                const pacmanCenterY = pacmanY + PACMAN_SIZE/2;
                
                const distance = Math.sqrt(
                    Math.pow(pacmanCenterX - pinkDot.x, 2) + 
                    Math.pow(pacmanCenterY - pinkDot.y, 2)
                );
                
                if (distance < 18) {
                    // –°–æ–±–∏—Ä–∞–µ–º —Ä–æ–∑–æ–≤—ã–π –∫—Ä—É–∂–æ–∫
                    pinkDot.collected = true;
                    pinkDot.element.remove();
                    console.log('–†–æ–∑–æ–≤—ã–π –∫—Ä—É–∂–æ–∫ —Å–æ–±—Ä–∞–Ω!');
                    
                    // TODO: –ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∞
                    onPinkDotCollected();
                }
            }

            // –î–µ–π—Å—Ç–≤–∏–µ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∞ —Ä–æ–∑–æ–≤–æ–≥–æ –∫—Ä—É–∂–∫–∞
            function onPinkDotCollected() {
                console.log('–ü–æ–±–µ–¥–∞!');
                winGame();
            }

            // –ü–æ–±–µ–¥–∞ –≤ –∏–≥—Ä–µ
            function winGame() {
                gameActive = false;
                stopPacman();
                
                // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤
                enemies.forEach(enemy => {
                    enemy.direction = null;
                });
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã
                document.getElementById('win-score').textContent = score;
                document.getElementById('win-screen').style.display = 'flex';
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞
            function updateScore() {
                const scoreElement = document.getElementById('score-display');
                scoreElement.textContent = `–°—á—ë—Ç: ${score}`;
            }
        
// –ó–∞–ø—É—Å–∫ –¥–≤–∏–∂–µ–Ω–∏—è
function startMoving(newDirection) {
    if (!gameActive || !gameStarted) return;
    direction = newDirection;
    isMoving = true;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ Pac-Man'–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º invincible
    if (isInvincible) {
        pacman.className = 'pacman ' + direction + ' moving invincible';
    } else {
        pacman.className = 'pacman ' + direction + ' moving';
    }
    
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ü–∏–∫–ª –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π
    if (gameLoop) clearInterval(gameLoop);
    gameLoop = setInterval(movePacman, 16); // ~60 FPS
}
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è
        function stopPacman() {
            isMoving = false;
            if (gameLoop) {
                clearInterval(gameLoop);
                gameLoop = null;
            }
                // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
            pacman.className = pacman.className.replace(' moving', '');
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        document.querySelectorAll('.arrow-btn').forEach(button => {
    button.addEventListener('click', function() {
        const newDirection = this.getAttribute('data-direction');
        
        // –î–æ–±–∞–≤–∏—Ç—å –≤–∏–±—Ä–∞—Ü–∏—é
        if ('vibrate' in navigator) {
            navigator.vibrate(50); // 50ms –≤–∏–±—Ä–∞—Ü–∏–∏
        }

        // –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ –º—ã—à—å—é
        this.classList.add('pressed');
        setTimeout(() => {
            this.classList.remove('pressed');
        }, 100);
        
        startMoving(newDirection);
    });
});
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        document.addEventListener('keydown', function(event) {
            let newDirection = '';
            switch(event.key) {
                case 'ArrowUp':
                case 'w':
                case 'W':
                    newDirection = 'up';
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                    newDirection = 'down';
                    break;
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    newDirection = 'left';
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    newDirection = 'right';
                    break;
            }
            
            if (newDirection) {
                startMoving(newDirection)
            }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        preloadImages().then(() => {
            console.log('–í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
            updateLives();
            // –ù–ï –∑–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω
        }).catch(error => {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:', error);
            updateLives();
            // –¢–æ–∂–µ –ù–ï –∑–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        });

        // –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü —Å–∫—Ä–∏–ø—Ç–∞
        document.addEventListener('touchstart', function(event) {
            if (event.touches.length > 1) {
                event.preventDefault(); // –û—Ç–∫–ª—é—á–∞–µ—Ç pinch-to-zoom
            }
        });

        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault(); // –û—Ç–∫–ª—é—á–∞–µ—Ç double-tap zoom
            }
            lastTouchEnd = now;
        }, false);


        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–∞–π–ø–∞–º–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;

        const minSwipeDistance = 30; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è —Å–≤–∞–π–ø–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞—á–∞–ª–∞ –∫–∞—Å–∞–Ω–∏—è
        document.addEventListener('touchstart', function(event) {
            touchStartX = event.changedTouches[0].screenX;
            touchStartY = event.changedTouches[0].screenY;
        }, false);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–Ω—Ü–∞ –∫–∞—Å–∞–Ω–∏—è
        document.addEventListener('touchend', function(event) {
            touchEndX = event.changedTouches[0].screenX;
            touchEndY = event.changedTouches[0].screenY;
            handleSwipe();
        }, false);

        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤–∞–π–ø–∞
        function handleSwipe() {
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∏—Å—Ç–∞–Ω—Ü–∏—é —Å–≤–∞–π–ø–∞
            if (Math.abs(deltaX) < minSwipeDistance && Math.abs(deltaY) < minSwipeDistance) {
                return; // –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π —Å–≤–∞–π–ø, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º
            }
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ –Ω–∞–∏–±–æ–ª—å—à–µ–º—É —Å–º–µ—â–µ–Ω–∏—é
            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø
                if (deltaX > 0) {
                    startMoving('right');
                    console.log('–°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ');
                } else {
                    startMoving('left');
                    console.log('–°–≤–∞–π–ø –≤–ª–µ–≤–æ');
                }
            } else {
                // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø
                if (deltaY > 0) {
                    startMoving('down');
                    console.log('–°–≤–∞–π–ø –≤–Ω–∏–∑');
                } else {
                    startMoving('up');
                    console.log('–°–≤–∞–π–ø –≤–≤–µ—Ä—Ö');
                }
            }
        }
    </script>
</body>
</html>